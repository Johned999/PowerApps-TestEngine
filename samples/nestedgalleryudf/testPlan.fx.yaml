testSuite:
  testSuiteName: Nested Gallery
  testSuiteDescription: Verifies that you can interact with controls within a nested gallery
  persona: User1
  appLogicalName: new_nestedgallery_a43df

  testCases:
    - testCaseName: Case1
      testSteps: |
        = Screenshot("nestedgallery_loaded.png");
          Assert(TextInput1.Text = "5", "Validate default number of columns to generate is 5");
          // Generate 1 row
          Select(Button1);
          // Validate that the row was generated with some data
          Assert(Index(Gallery1.AllItems, 1).Label4.Text = "Row id: 1", "Validate row label");
          // Change the labels and verify
          SetProperty(Index(Gallery1.AllItems, 1).Label4.Text, "Updated label");
          Assert(Index(Gallery1.AllItems, 1).Label4.Text = "Updated label", "Validate row label");
          Assert(Index(Index(Gallery1.AllItems, 1).Gallery2.AllItems, 3).Label5.Text = "Column id: 3", "Validate the label in the nested gallery");
          SetProperty(Index(Index(Gallery1.AllItems, 1).Gallery2.AllItems, 3).Label5.Text, "Updated label");
          Assert(Index(Index(Gallery1.AllItems, 1).Gallery2.AllItems, 3).Label5.Text = "Updated label", "Validate the label in the nested gallery");
          // Generate a 2nd row
          GenerateRow(10);
          Assert(Index(Gallery1.AllItems, 2).Label4.Text = "Row id: 2", "Validate row label");
          Assert(Index(Index(Gallery1.AllItems, 2).Gallery2.AllItems, 10).Label5.Text = "Column id: 10", "Validate the label in the nested gallery");
          // Ensure that selected data is null
          Assert(IsBlank(Label3.Text), "Validate that the selected row is empty");
          Assert(IsBlank(Label8.Text), "Validate that the selected column is empty");
          // Click 2nd row in the gallery
          TestSelectRow(2);
          // Click 4th column in 1st row in the gallery
          TestSelectRowColumn(1, 4);
          
          GenerateRow(6);
          TestSelectRow(3);
          TestSelectRowColumn(3, 5);
          Screenshot("nestedgallery_end.png");

userDefinedFunctions: >
                    GenerateRow(x: Number): Number => { SetProperty(TextInput1.Text, ""&x); Select(Button1); 0+0; };
                    
                    TestSelectRow(row: Number): Number => { 
                        Select(Index(Gallery1.AllItems, row).Icon2);
                        Assert(Label3.Text = ""&row, "Validate that the selected row is updated");
                        Assert(Label8.Text = "0", "Validate that the selected column is reset");
                        1+1;
                    };
                    
                    TestSelectRowColumn(row: Number, column: Number): Number => {
                        Select(Index(Index(Gallery1.AllItems, row).Gallery2.AllItems, column).Icon3);
                        Assert(Label3.Text = ""&row, "Validate that the selected row is updated");
                        Assert(Label8.Text = ""&column, "Validate that the selected column is updated");
                        1+1;
                    };
                    

testSettings:
  recordVideo: true
  browserConfigurations:
    - browser: Chromium

environmentVariables:
  users:
    - personaName: User1
      emailKey: user1Email
      passwordKey: user1Password
